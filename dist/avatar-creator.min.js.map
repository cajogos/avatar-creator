{"version":3,"sources":["MiniYou.js","Compiler.js","Avatar.js","Canvas.js","Editor.js"],"names":["MINI_YOU","EDITOR","undefined","init","editorElement","canvasElement","Editor","CANVAS","attachListener","Canvas","Compiler","prototype","constructor","compileCode","code","json","JSON","parse","console","log","Avatar","canvas","this","_initDraw","POINTS","HEAD","BODY","RIGHT_ARM","RIGHT_LEG","LEFT_LEG","LEFT_ARM","strokeStyle","BODY_SHAPE_1","ctx","_canvas","get2DContext","fillStyle","drawPolygon","processData","data","head","_createHead","color","headPoints","getContext","$","after","e","text","offsetX","offsetY","_width","width","_height","height","_init","_avatar","_ctx","fillRect","pixel","xValues","drawLine","i","j","message","handleEditorAlert","getWidth","lineTo","getHeight","stroke","startX","startY","points","moveTo","curX","curY","fill","beginPath","length","closePath","_compiler","_listeners","self","on","parseText","_element","keyCode","preventDefault","end","get","selectionEnd","val","selectionStart","start","substring","listener","push","_alertListeners","result","css","setText"],"mappings":"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","file":"avatar-creator.min.js","sourcesContent":["let MINI_YOU = {\n    EDITOR: undefined,\n    CANVAS: undefined,\n    initialized: false\n};\n\n/**\n *\n * @param {jQuery|HTMLElement} editorElement\n * @param {jQuery|HTMLElement} canvasElement\n */\nMINI_YOU.init = function (editorElement, canvasElement)\n{\n    MINI_YOU.EDITOR = new MINI_YOU.Editor(editorElement);\n    MINI_YOU.CANVAS = new MINI_YOU.Canvas(canvasElement);\n    MINI_YOU.EDITOR.attachListener(MINI_YOU.CANVAS);\n    MINI_YOU.initialized = true;\n};","MINI_YOU.Compiler = function ()\n{\n};\nMINI_YOU.Compiler.prototype.constructor = MINI_YOU.Compiler;\n\n/**\n * @param {string} code\n */\nMINI_YOU.Compiler.prototype.compileCode = function (code)\n{\n    let json = JSON.parse(code);\n\n\n\n    console.log(json);\n\n    return json;\n};","/**\n * @param {MINI_YOU.Canvas} canvas\n * @constructor\n */\nMINI_YOU.Avatar = function (canvas)\n{\n    this._canvas = canvas;\n\n    this._initDraw();\n};\nMINI_YOU.Avatar.prototype.constructor = MINI_YOU.Avatar;\n\nMINI_YOU.Avatar.POINTS = {\n    HEAD: [\n        [192, 64],\n        [288, 64],\n        [288, 160],\n        [192, 160]\n    ],\n    BODY: [\n        [160, 160],\n        [320, 160],\n        [320, 320],\n        [160, 320]\n    ],\n    // Arms\n    RIGHT_ARM: [\n        [96, 160],\n        [160, 160],\n        [160, 320],\n        [96, 320]\n    ],\n    LEFT_ARM: [\n        [320, 160],\n        [384, 160],\n        [384, 320],\n        [320, 320]\n    ],\n    // Legs\n    RIGHT_LEG: [\n        [160, 320],\n        [224, 320],\n        [224, 480],\n        [160, 480]\n    ],\n    LEFT_LEG: [\n        [256, 320],\n        [320, 320],\n        [320, 480],\n        [256, 480]\n    ]\n};\n\nMINI_YOU.Avatar.BODY_SHAPE_1 = {\n    POINTS: [\n        [224, 144], [192, 144], [192, 64], [288, 64], [288, 144], [256, 144],\n        [256, 160], [352, 160],\n        // Left Arm\n        [352, 320], [304, 320], [304, 208], [304, 320],\n        // Left Leg\n        [304, 464], [256, 464], [256, 320],\n        // Torso\n        [224, 320],\n        // Right Leg\n        [224, 464], [176, 464], [176, 320],\n        // Right Arm\n        [176, 208], [176, 320], [128, 320], [128, 160], [224, 160]\n    ]\n};\n\nMINI_YOU.Avatar.prototype._initDraw = function ()\n{\n    let ctx = this._canvas.get2DContext();\n    ctx.strokeStyle = 'black';\n\n/*\n    // Head\n    this._createHead('red');\n\n    // Body\n    let bodyPoints = MINI_YOU.Avatar.POINTS.BODY;\n    ctx.fillStyle = 'blue';\n    this._canvas.drawPolygon(bodyPoints[0][0], bodyPoints[0][1], bodyPoints, true, true);\n\n    // Right Arm\n    let rightArmPoints = MINI_YOU.Avatar.POINTS.RIGHT_ARM;\n    ctx.fillStyle = 'violet';\n    this._canvas.drawPolygon(rightArmPoints[0][0], rightArmPoints[0][1], rightArmPoints, true, true);\n\n    // Left Arm\n    let leftArmPoints = MINI_YOU.Avatar.POINTS.LEFT_ARM;\n    ctx.fillStyle = 'orange';\n    this._canvas.drawPolygon(leftArmPoints[0][0], leftArmPoints[0][1], leftArmPoints, true, true);\n\n    // Right Leg\n    let rightLegPoints = MINI_YOU.Avatar.POINTS.RIGHT_LEG;\n    ctx.fillStyle = 'lime';\n    this._canvas.drawPolygon(rightLegPoints[0][0], rightLegPoints[0][1], rightLegPoints, true, true);\n\n    // Left Leg\n    let leftLegPoints = MINI_YOU.Avatar.POINTS.LEFT_LEG;\n    ctx.fillStyle = 'yellow';\n    this._canvas.drawPolygon(leftLegPoints[0][0], leftLegPoints[0][1], leftLegPoints, true, true);\n*/\n\n    // Full Body\n    ctx.fillStyle = '#CCC';\n    this._canvas.drawPolygon(\n        MINI_YOU.Avatar.BODY_SHAPE_1.POINTS[0][0],\n        MINI_YOU.Avatar.BODY_SHAPE_1.POINTS[0][1],\n        MINI_YOU.Avatar.BODY_SHAPE_1.POINTS,\n        true,\n        true\n    );\n};\n\nMINI_YOU.Avatar.prototype.processData = function (data)\n{\n    console.log('data', data);\n    // Head\n    if (data.head)\n    {\n        // this._createHead(data.head.color);\n    }\n};\n\nMINI_YOU.Avatar.prototype._createHead = function (color)\n{\n    let ctx = this._canvas.get2DContext();\n\n    let headPoints = MINI_YOU.Avatar.POINTS.HEAD;\n    ctx.fillStyle = color;\n    this._canvas.drawPolygon(headPoints[0][0], headPoints[0][1], headPoints, true, true);\n};","/**\n * @param canvas\n * @constructor\n */\nMINI_YOU.Canvas = function (canvas)\n{\n    this._canvas = canvas[0];\n    this._ctx = this._canvas.getContext('2d');\n\n    $(canvas).after('<div class=\"debugger\"></div>');\n    $(canvas).on('mousemove', function(e)\n    {\n        $('div.debugger').text('x: ' + e.offsetX + ' | y: ' + e.offsetY);\n    });\n\n    this._width = this._canvas.width;\n    this._height = this._canvas.height;\n\n    this._init();\n\n    this._avatar = new MINI_YOU.Avatar(this);\n};\nMINI_YOU.Canvas.prototype.constructor = MINI_YOU.Canvas;\n\nMINI_YOU.Canvas.prototype._init = function ()\n{\n    this._ctx.fillStyle = 'white';\n    this._ctx.fillRect(0, 0, this._width, this._height);\n\n    // Draw a grid\n    this._ctx.strokeStyle = '#EAEAEA';\n    let pixel = 16;\n\n    let xValues = '';\n    for (let i = 0; i < this._width; i += pixel)\n    {\n        this.drawLine(i, 0, i, this._height);\n        xValues += i + ', ';\n    }\n    console.log(xValues);\n    for (let j = 0; j < this._height; j += pixel)\n    {\n        this.drawLine(0, j, this._width, j);\n    }\n};\n\n/**\n * @returns {CanvasRenderingContext2D|*}\n */\nMINI_YOU.Canvas.prototype.get2DContext = function ()\n{\n    return this._ctx;\n};\n\nMINI_YOU.Canvas.prototype.handleEditorAlert = function (message, data)\n{\n    if (message === 'jsonChanged')\n    {\n        this._avatar.processData(data);\n    }\n};\n\nMINI_YOU.Canvas.prototype.getWidth = function ()\n{\n    return this._width;\n};\n\nMINI_YOU.Canvas.prototype.getHeight = function ()\n{\n    return this._height;\n};\n\nMINI_YOU.Canvas.prototype.drawLine = function (startX, startY, endX, endY)\n{\n    this._ctx.beginPath();\n    this._ctx.moveTo(startX, startY);\n    this._ctx.lineTo(endX, endY);\n    this._ctx.closePath();\n    this._ctx.stroke();\n};\n\nMINI_YOU.Canvas.prototype.drawPolygon = function (startX, startY, points, fill, stroke)\n{\n    this._ctx.beginPath();\n    this._ctx.moveTo(startX, startY);\n\n    for (let i = 0; i < points.length; i++)\n    {\n        let curX = points[i][0];\n        let curY = points[i][1];\n\n        this._ctx.lineTo(curX, curY);\n    }\n    this._ctx.closePath();\n\n    if (fill === true)\n    {\n        this._ctx.fill();\n    }\n\n    if (stroke === true)\n    {\n        this._ctx.stroke();\n    }\n};","MINI_YOU.Editor = function (editorElement)\n{\n    this._element = editorElement;\n\n    this._compiler = new MINI_YOU.Compiler();\n\n    this._listeners = [];\n\n    let self = this;\n    this._element.on('keyup', function (e)\n    {\n        self.parseText();\n    });\n    this._element.on('keydown', function (e)\n    {\n        switch (e.keyCode)\n        {\n            case 9: // Tab Key\n                e.preventDefault();\n                let start = $(this).get(0).selectionStart;\n                let end = $(this).get(0).selectionEnd;\n                $(this).val($(this).val().substring(0, start) + \"    \" + $(this).val().substring(end));\n                $(this).get(0).selectionStart = $(this).get(0).selectionEnd = start + 4;\n                break;\n        }\n    });\n};\nMINI_YOU.Editor.prototype.constructor = MINI_YOU.Editor;\n\nMINI_YOU.Editor.prototype.attachListener = function (listener)\n{\n    this._listeners.push(listener);\n};\n\nMINI_YOU.Editor.prototype._alertListeners = function (message, data)\n{\n    for (let i = 0; i < this._listeners.length; i++)\n    {\n        this._listeners[i].handleEditorAlert(message, data);\n    }\n};\n\nMINI_YOU.Editor.prototype.parseText = function ()\n{\n    let text = this._element.val();\n    try\n    {\n        let result = this._compiler.compileCode(text);\n\n        this._element.css({\n            'background': 'black',\n            'color': 'white'\n        });\n\n        this._alertListeners('jsonChanged', result);\n    }\n    catch (e)\n    {\n        console.error(e);\n        this._element.css({\n            'background': 'darkred',\n            'color': 'red'\n        });\n    }\n};\n\nMINI_YOU.Editor.prototype.setText = function (text)\n{\n    this._element.val(text);\n    this.parseText();\n};"]}